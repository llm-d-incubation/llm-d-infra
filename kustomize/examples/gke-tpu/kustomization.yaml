apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# GKE L7 gateway for TPU workloads
# Use this for: GKE clusters running TPU-based LLM inference

resources:
  - ../../overlays/gke

namespace: llm-d

commonLabels:
  workload-type: tpu
  gateway.llm-d.ai/accelerator: google-tpu

# Optional: Add GKE-specific annotations for TPU optimization
patches:
  - patch: |-
      - op: add
        path: /metadata/annotations
        value:
          cloud.google.com/neg: '{"exposed_ports": {"80":{}}}'
          cloud.google.com/backend-config: '{"default": "tpu-backend-config"}'
    target:
      kind: Gateway
      name: llm-d-gateway